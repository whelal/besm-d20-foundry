<form class="{{cssClass}} flexcol">
  {{!-- Sheet Header --}}
  <header class="sheet-header flexrow">
    <img class="profile" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="80" width="80"/>
    <div class="header-fields flexcol">
      <h1 class="charname"><input name="name" type="text" value="{{actor.name}}" placeholder="{{localize 'BESMD20.NPCName'}}"/></h1>
      <div class="resource-row flexrow">
        <div class="resource">
          <label>{{localize "BESMD20.Health"}}</label>
          <div class="resource-content flexrow">
            <input type="text" name="system.health.value" value="{{system.health.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.health.max" value="{{system.health.max}}" data-dtype="Number"/>
          </div>
        </div>
        <div class="resource">
          <label>{{localize "BESMD20.Energy"}}</label>
          <div class="resource-content flexrow">
            <input type="text" name="system.energy.value" value="{{system.energy.value}}" data-dtype="Number"/>
            <span> / </span>
            <input type="text" name="system.energy.max" value="{{system.energy.max}}" data-dtype="Number"/>
          </div>
        </div>
        <div class="resource">
          <label>{{localize "BESMD20.Defense"}}</label>
          <div class="resource-content">
            <input type="text" name="system.defense.value" value="{{system.defense.value}}" data-dtype="Number"/>
          </div>
        </div>
      </div>
    </div>
  </header>

  {{!-- Sheet Tab Navigation --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="main">{{localize "BESMD20.Tabs.Main"}}</a>
    <a class="item" data-tab="powers">{{localize "BESMD20.Tabs.Powers"}}</a>
    <a class="item" data-tab="bio">{{localize "BESMD20.Tabs.Biography"}}</a>
  </nav>

  {{!-- Sheet Body --}}
  <section class="sheet-body">
    {{!-- Main Tab --}}
    <div class="tab" data-group="primary" data-tab="main">
      <div class="grid grid-2col">
        {{!-- Abilities Block --}}
        <div class="abilities">
          <h3 class="items-header">{{localize "BESMD20.Abilities"}}</h3>
          <ol class="abilities-list">
            {{#each system.abilities as |ability key|}}
            <li class="ability flexrow">
              <h4 class="ability-name rollable" data-roll="1d20+@abilities.{{key}}.mod" data-label="{{key}}">{{localize (lookup config.abilities key)}}</h4>
              <input class="ability-score" name="system.abilities.{{key}}.value" type="text" value="{{ability.value}}" data-dtype="Number"/>
              <div class="ability-modifier rollable" data-roll="1d20+@abilities.{{key}}.mod" data-label="{{key}}">{{numberFormat ability.mod decimals=0 sign=true}}</div>
            </li>
            {{/each}}
          </ol>
        </div>

        {{!-- NPC Details --}}
        <div class="character-details">
          <h3 class="items-header">{{localize "BESMD20.Details"}}</h3>
          <ol class="details-list">
            <li class="detail flexrow">
              <label>{{localize "BESMD20.ChallengeRating"}}</label>
              <input type="text" name="system.cr" value="{{system.cr}}" data-dtype="Number"/>
            </li>
            <li class="detail flexrow">
              <label>{{localize "BESMD20.NPCType"}}</label>
              <select name="system.type">
                <option value="minion" {{#if (eq system.type "minion")}}selected{{/if}}>{{localize "BESMD20.Minion"}}</option>
                <option value="lieutenant" {{#if (eq system.type "lieutenant")}}selected{{/if}}>{{localize "BESMD20.Lieutenant"}}</option>
                <option value="boss" {{#if (eq system.type "boss")}}selected{{/if}}>{{localize "BESMD20.Boss"}}</option>
              </select>
            </li>
          </ol>
        </div>
      </div>
    </div>

    {{!-- Powers Tab --}}
    <div class="tab" data-group="primary" data-tab="powers">
      <div class="items-header flexrow">
        <h3>{{localize "BESMD20.Powers"}}</h3>
        <a class="item-control item-create" title="{{localize 'BESMD20.ItemCreate'}}" data-type="power">
          <i class="fas fa-plus"></i> {{localize "BESMD20.Add"}}
        </a>
      </div>
      <ol class="items-list">
        <li class="item-header flexrow">
          <div class="item-name">{{localize "BESMD20.Name"}}</div>
          <div class="item-rank">{{localize "BESMD20.Rank"}}</div>
          <div class="item-cost">{{localize "BESMD20.Cost"}}</div>
          <div class="item-controls"></div>
        </li>
        {{#each powers as |item id|}}
        <li class="item flexrow" data-item-id="{{item.id}}">
          <div class="item-name">
            <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
            <h4>{{item.name}}</h4>
          </div>
          <div class="item-rank">{{item.system.rank}}</div>
          <div class="item-cost">{{item.system.totalCost}}</div>
          <div class="item-controls">
            <a class="item-control item-activate" title="{{localize 'BESMD20.Activate'}}"><i class="fas fa-magic"></i></a>
            <a class="item-control item-edit" title="{{localize 'BESMD20.ItemEdit'}}"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete" title="{{localize 'BESMD20.ItemDelete'}}"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        {{/each}}
      </ol>
    </div>

    {{!-- Biography Tab --}}
    <div class="tab" data-group="primary" data-tab="bio">
      <div class="grid grid-1col">
        <div class="editor">
          <label>{{localize "BESMD20.Biography"}}</label>
          {{editor system.biography target="system.biography" button=true editable=editable}}
        </div>
        <div class="editor">
          <label>{{localize "BESMD20.Notes"}}</label>
          {{editor system.notes target="system.notes" button=true editable=editable}}
        </div>
      </div>
    </div>

  </section>
</form>